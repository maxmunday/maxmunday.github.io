---
layout: post
title: "PentesterLab Bootcamp - HTTP"
date: 2016-05-22
description: "Walk-through guide to PentesterLab's bootcamp."
number: "0x04"
---
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

This is part 2 of my write-up of PentesterLab's [Bootcamp](https://pentesterlab.com/bootcamp) course. If you see any errors or want to suggest I do something different, please [contact me](https://www.maxmunday.com/contact/) to let me know.

Write-up parts [1](https://www.maxmunday.com/blog/2016/05/14/pentesterlab-bootcamp-part-1-linux-and-scripting), [2](https://www.maxmunday.com/blog/2016/05/22/pentesterlab-bootcamp-part-2-http), [3](https://www.maxmunday.com/blog/2016/05/27/pentesterlab-bootcamp-part-3-php-and-dns), [4](https://www.maxmunday.com/blog/2016/08/09/pentesterlab-bootcamp-part-4-ssl-tls), [5.1](https://www.maxmunday.com/blog/2017/01/04/pentesterlab-bootcamp-part-5.1-sql-injection), [5.2](https://www.maxmunday.com/blog/2017/01/18/pentesterlab-bootcamp-part-5.2-local-file-include).

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

<pre>
                   * * * [ DISCLAIMER ] * * *
/*
 * All information in this write-up is, to the best of my knowledge,  
 * truthful and accurate. However, I am only new to this, and I am   
 * learning as I go, so it is entirely possible something contained  
 * within this write-up is incorrect in some way. Never execute any  
 * command, without knowing for sure what it is you are doing. Look  
 * at the man pages of all commands if you do not understand them.  
 *
 * I take no responsibility if you decide to use this information   
 * to commit illegal acts. If you attempt to use these techniques  
 * against devices or networks you do not either own, or have    
 * permission to attack, you could end up in prison.  
 *
 */  
</pre>
 
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

\-\-[ Step 2 ]

The second step in the course is titled HTTP. It asks us to install Apache into the VM, and configure correctly so we can navigate to the site on our host browser. I will also assign the name 'vulnerable' to the VM in the host file.

I will then write some HTTP clients in Python to retrieve the home page of our site. Finally I will check out [Burp Suite](www.portswigger.net/burp/downloadfree.html) and view the requests and responses that are sent and received when visiting a website.

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

\-\-[ Installing Apache ]

Installing Apache is quite straight forward. After updating your system to ensure your repositories are up to date, we install Apache:

{% highlight shell %}
$ sudo apt-get update         
$ sudo apt-get install apache2
{% endhighlight %}

Once it is complete, it should already be up and running. To ensure it is working, open your browser and navigate to 'localhost' or '127.0.0.1'. It should display this page:

![](/pictures/apache_1.png){:height="379px" width="615px"}

To check further, type this command into the terminal:

{% highlight shell %}
$ netstat -an | more
{% endhighlight %}

Netstat prints the network connections, among other things, of your system. In this case we are checking to see if the system is listening on port 80. As we can see from this screenshot, it is.

![](/pictures/apache_2.png){:height="379px" width="615px"}

Run the following to find your IP address:

{% highlight shell %}
$ ifconfig
{% endhighlight %}

![](/pictures/apache_3.png){:height="379px" width="615px"}

We can see here our IP address for the webserver is 192.168.128.49. Use that address in your host browser and it should be able to access it as well.

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

\-\-[ Changing the Home Page ]

Another reasonably easy step. The HTML index file that is the home page can be found at /var/www/html/index.html, and can be edited with a text editor.

{% highlight shell %}
$ sudo nano /var/www/html/index.html
{% endhighlight %}

![](/pictures/apache_4.png){:height="379px" width="615px"}

We can then change the HTML code and change the home page of the website.

![](/pictures/apache_5.png){:height="379px" width="615px"}

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

\-\-[ Changing the Hosts File ]

To assign the Linux system as 'vulnerable' we need to edit the hosts file. It is located at /etc/hosts. To edit it type:

{% highlight shell %}
$ sudo nano /etc/hosts
{% endhighlight %}

Then add the IP address that we found via `ifconfig`, and assign the name vulnerable.

![](/pictures/apache_6.png){:height="379px" width="615px"}

Then to access the page in the browser simply type 'vulnerable' in the address bar.

![](/pictures/apache_7.png){:height="379px" width="615px"}

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

\-\-[ Writing HTTP Clients ]

I will write some HTTP clients, which send a HTTP GET request to the site that will essentially retrieve HTML code from the website as a response.

The first HTTP client I wrote in Python using the urllib2 library.

{% highlight python linenos %}
#!/usr/bin/python
# HTTP Client 

import urllib2

r = urllib2.urlopen('http://vulnerable/')

print r.read()

r.close()
{% endhighlight %}

When executed it displays the response, which is the HTML code that we used to build the homepage.

![](/pictures/http_client_2.png){:height="315px" width="496px"}

Next I wrote an HTTP client, again in Python, using a socket. 

{% highlight python linenos %}
#!/usr/bin/python
# HTTP Client with Socket

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(("vulnerable" , 80))

s.sendall("GET /\r\n")
print s.recv(4096)

s.close
{% endhighlight %}

Again, when executed it displays the response, which is the HTML code that we used to build the homepage.

![](/pictures/http_client_4.png){:height="315px" width="496px"}

EDIT: Although PentesterLab states the HTTP Client must only retrieve the home page from the site, I decided to add another script that is probably a better HTTP Client as it pulls the HTTP header information as well. It can also be modified easily to send a POST request, rather than just a GET request.

{% highlight python linenos %}
#!/usr/bin/python
# HTTP Client with Header Info

import httplib

# connect to HTTP server, send GET request, receive response
h = httplib.HTTPConnection('vulnerable')
h.request('GET', '')
r = h.getresponse()

# get and print HTTP header response
rh = r.getheaders()
print 'Header:'
for i in rh:
    print i[0], ':', i[1]
print '\n'

# get and print content of response
rr = r.read()
print 'Content:'
print rr
print '\n'

# close HTTP connection to server
h.close()
{% endhighlight %}

![](/pictures/http_client_6.png){:height="315px" width="496px"}


\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

\-\-[ Burp Suite ]

Finally, we will see what requests are sent and what responses are received when visiting a website while using [Burp Suite](https://portswigger.net/burp/).

![](/pictures/burp_1.png){:height="472px" width="750px"}

![](/pictures/burp_2.png){:height="472px" width="750px"}

![](/pictures/burp_3.png){:height="472px" width="750px"}


\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

/*\*\* [Part 1 - Linux and Scripting](https://www.maxmunday.com/blog/2016/05/14/pentesterlab-bootcamp-part-1-linux-and-scripting) \*\*\*/

/*\*\* [Part 3 - PHP and DNS](https://www.maxmunday.com/blog/2016/05/27/pentesterlab-bootcamp-part-3-php-and-dns) \*\*\*/

/*\*\* [Part 4 - SSL/TLS](https://www.maxmunday.com/blog/2016/08/09/pentesterlab-bootcamp-part-4-ssl-tls) \*\*\*/

/*\*\* [Part 5.1 - SQL Injection](https://www.maxmunday.com/blog/2017/01/04/pentesterlab-bootcamp-part-5.1-sql-injection) \*\*\*/

/*\*\* [Part 5.2 - Local File Include](https://www.maxmunday.com/blog/2017/01/18/pentesterlab-bootcamp-part-5.2-local-file-include) \*\*\*/

/*\*\* Part 6- More SQL Injection COMING SOON \*\*\*/

\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
